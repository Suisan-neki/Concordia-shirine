# Concordia Shrine

> 「ヒューマンセキュリティなくしてサイバーセキュリティは実現しない」

対話の「空気」を可視化し、判断の自由をそっと守る祠プロダクト。

## コンセプト

Concordia Shrineは、会議やミーティングにおける「見えない圧力」を可視化するWebアプリケーションです。

### 守りたいもの

- **「はい」と言ってしまう0.5秒前の、まだ自由な心**
- **気まずさや沈黙のせいで飲み込まれてしまう違和感**
- **場の空気に押し流される前の「本当はこう思っている」の可能性**

### Human Decision Security

従来のセキュリティは、外部からの攻撃（External Threat）を防ぐことに焦点を当ててきました。
しかし、Concordia Shrineは**「内在的脅威（Intrinsic Threat）」**――すなわち、集団心理や同調圧力によって個人の判断が歪められるリスク――から、人の心を防御します。

技術的な防御（サイバーセキュリティ）が、心理的な安全（ヒューマンセキュリティ）を支え、
その逆もまた真なのです。

### 合意形成の保護 (Consent Protection)

- **不本意な合意の防止**: 場の空気に流されて「はい」と言ってしまう前に、客観的なデータ（波の赤色化など）で警告を発します。
- **真正な合意の支援**: 全員が安心して発言できる「調和」の状態（緑色の豊かな波）こそが、真の合意形成の土台であると定義します。

## 機能

### 空気の可視化

- **波の生成**: Perlin Noiseベースの有機的な波が、対話の「空気」をリアルタイムで表現
- **シーン判定**: 静寂、調和、一方的、沈黙の4つの状態を自動検出
- **セキュリティバリア**: 画面端の光が「結界」として、保護状態を視覚化

### 介入機能

- **リアルタイム検知**: 「一方的」や「沈黙」状態が続くと自動で検知
- **穏やかな通知**: 通知音とヒントメッセージで、参加者に気づきを促す
- **カスタマイズ可能**: 介入のタイミングや方法を設定可能

### レポート出力

- **セッション分析**: 対話の傾向やセキュリティスコアを分析
- **Markdown/HTML出力**: 振り返りに活用できるレポートを生成

### 気づかないうちに守られている

以下のセキュリティ機能が、ユーザーが意識することなくバックグラウンドで動作しています：

| 機能 | 説明 |
|------|------|
| **暗号化** | セッションデータはAES-256-GCMで暗号化 |
| **レート制限** | 異常なアクセスパターンを自動ブロック |
| **入力サニタイズ** | XSS/SQLインジェクション対策 |
| **監査ログ** | セキュリティイベントを自動記録 |
| **CSRF保護** | フォーム送信時のトークン検証 |

ログインユーザーは「詳細」ボタンから、これらの守護者たちの働きを確認できます。

## 技術スタック

- **フロントエンド**: React 19 + TypeScript + Tailwind CSS 4
- **バックエンド**: Express + tRPC
- **データベース**: MySQL (TiDB)
- **認証**: OAuth 2.0 + JWT
- **波生成**: Perlin Noise Algorithm
- **音声分析**: Web Audio API + Web Speech API

## 開発

```bash
# 依存関係のインストール
pnpm install

# 開発サーバーの起動
pnpm dev

# データベースのマイグレーション
pnpm db:push

# テストの実行
pnpm test
```

## ディレクトリ構成

```text
Concordia-shirine-1
├── cdk/                  # AWS CDK インフラストラクチャ (TypeScript)
│   ├── lib/stacks/       # スタック定義
│   └── lib/lambdas/      # カスタムリソースハンドラ
├── client/               # フロントエンドアプリケーション (React 19 + Vite)
│   └── src/
│       ├── components/   # UIコンポーネント (Radix UI + Framer Motion)
│       ├── lib/          # コアロジック (WaveEngine, ConversationLog)
│       └── pages/        # アプリケーションルート
├── server/               # バックエンドAPI (Node.js + tRPC)
│   ├── services/         # ビジネスロジック・サービス層
│   ├── _core/            # コアユーティリティ (認証、セキュリティ)
│   └── routers.ts        # APIルーター定義
├── src/                  # Python AI & 処理サービス
│   └── aws-lambdas/      # AWS Lambda 関数
│       ├── coach/               # AIコーチングエージェント
│       ├── llm_analysis/        # 詳細な会話分析
│       ├── realtime_transcribe/ # リアルタイム文字起こし
│       └── ...                  # 音声処理パイプライン (話者分離など)
└── docs/                 # プロジェクトドキュメント
```

## 哲学

> あなたがこの祠を訪れた瞬間、見えない結界が展開されました。
> 
> それは、あなたが気づくことなく、静かに、しかし確実に動き始めています。
> あなたの言葉を守り、あなたの判断の自由を守り、
> あなたが安心して対話できる空間を創り出すために。
> 
> これは、技術が人を守る物語です。

詳しくは [システムアーキテクチャ詳細](docs/architecture.md) をご覧ください。

## ライセンス

MIT License

---

Concordia Shrine — Human Decision Security
